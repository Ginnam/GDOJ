(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{0:function(e,t){},1:function(e,t){},2:function(e,t){},"3jW1":function(e,t){},xbUP:function(e,t,s){"use strict";s.r(t);var a=s("Iab2"),o=s.n(a),r=s("EUZL"),n=s.n(r),c={name:"givechoiceproblemscore",data:function(){return{singalscore:"",studentcount:"",type:1,isadmin:!1,canshow:!1,standardanswer:"",tableData:[],contestid:"",scoreform:{ContestId:"",ChoiceProblemAnswer:"",one_pro_score:""}}},methods:{exportExcel:function(){var e=n.a.utils.table_to_book(document.querySelector("#out-table")),t=n.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{o.a.saveAs(new Blob([t],{type:"application/octet-stream"}),"ChoiceProblemScores.xlsx")}catch(e){"undefined"!=typeof console&&this.$message.error(e)}return t},SubmitScore:function(){var e=this;this.$confirm("确定提交评阅分数吗？数据库中学生分数将在后台完成更新。",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.scoreform.ContestId=e.$route.query.contestid,e.scoreform.ChoiceProblemAnswer=e.standardanswer,e.scoreform.one_pro_score=e.singalscore,e.$axios.post("/scorecontestchoiceproblems",e.scoreform).then(function(t){e.$message({message:t.data,type:"success"})}).catch(function(t){e.$message.error("提交评阅失败！请再提交一次。可能是你没有登录，或者后台出错，请联系管理员查看后台输出日志以获取错误信息("+JSON.stringify(t.response.data)+")")})})},Score:function(){for(var e=this.standardanswer.toUpperCase(),t=0;t<this.studentcount;t++){for(var s=this.tableData[t].answer,a=Number(0),o=0;o<e.length;o++)s[o]===e[o]&&(a+=Number(this.singalscore));this.tableData[t].score=Number(a)}}},created:function(){var e=this;if(this.type=sessionStorage.type,2!=this.type&&3!=this.type)return this.$message.error("非法访问！"),void(this.canshow=!1);this.canshow=!0,3==this.type&&(this.isadmin=!0),this.contestid=this.$route.query.contestid,this.$axios.get("/conteststudentchoiceanswer/?contestid="+this.contestid).then(function(t){e.tableData=t.data,e.studentcount=t.data.length})}},i=s("JFUb"),l=Object(i.a)(c,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-tabs",{directives:[{name:"show",rawName:"v-show",value:e.canshow,expression:"canshow"}],attrs:{type:"border-card"}},[s("el-row",[s("el-row",[s("el-input",{attrs:{placeholder:"请输入一道题的分值（一题多少分）",clearable:""},model:{value:e.singalscore,callback:function(t){e.singalscore=t},expression:"singalscore"}}),e._v(" "),s("el-col",[s("el-input",{attrs:{placeholder:"请输入正确答案(不区分大小写)",clearable:""},model:{value:e.standardanswer,callback:function(t){e.standardanswer=t},expression:"standardanswer"}})],1)],1),e._v(" "),s("el-row",[s("el-button",{attrs:{type:"success",disabled:!e.isadmin},on:{click:e.Score}},[e._v("评阅")])],1),e._v(" "),s("el-row",[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,id:"out-table"}},[s("el-table-column",{attrs:{prop:"username",label:"用户名",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"realname",label:"真实姓名",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"number",label:"学号",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"answer",label:"学生答案",width:"400"}}),e._v(" "),s("el-table-column",{attrs:{prop:"score",label:"分数",width:"180"}})],1)],1),e._v(" "),s("el-row"),e._v(" "),s("el-button",{attrs:{type:"success",disabled:!e.isadmin},on:{click:e.SubmitScore}},[e._v("提交评阅")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:!e.isadmin},on:{click:e.exportExcel}},[e._v("导出表格")]),e._v(" "),s("el-alert",{attrs:{title:"数据库中保存有学生答题的详细信息，包含了学生选的选项描述，选择题题目，选择题id，学生用户名，真实姓名，最后一次提交答案的时间",type:"info"}})],1)],1)},[],!1,function(e){s("3jW1")},"data-v-eaf6ca96",null);t.default=l.exports}}]);